#ifndef JSONRPC_SERVICE_H
#define JSONRPC_SERVICE_H

#include "jsonrpc.h"
#include "defs.h"
EXTERN_C_BLOCK


// 方法处理函数类型
typedef cJSON* (*jsonrpc_method_handler)(cJSON *params, cJSON *id, void *user_data);


/**********************************************************************
 * 函数名称：jsonrpc_service_create
 * 功能描述：创建JSON-RPC服务端
 * 输入参数：无
 * 输出参数：无
 * 返 回 值：    状态码
 * 其它说明：
 * 修改日期        版本号     修改人        修改内容
 * -----------------------------------------------
 * 2025/11/10        V1.0              chengjiahao
 ***********************************************************************/
HANDLE jsonrpc_service_create(int port, void* ptUserData);

/**********************************************************************
 * 函数名称：jsonrpc_service_free
 * 功能描述：释放JSON-RPC服务端
 * 输入参数：无
 * 输出参数：无
 * 返 回 值：    状态码
 * 其它说明：
 * 修改日期        版本号     修改人        修改内容
 * -----------------------------------------------
 * 2025/11/10        V1.0              chengjiahao
 ***********************************************************************/
void jsonrpc_service_free(HANDLE hService);

/**********************************************************************
 * 函数名称：jsonrpc_service_register_method
 * 功能描述：注册JSON-RPC方法
 * 输入参数：无
 * 输出参数：无
 * 返 回 值：    状态码
 * 其它说明：
 * 修改日期        版本号     修改人        修改内容
 * -----------------------------------------------
 * 2025/11/10        V1.0              chengjiahao
 ***********************************************************************/
E_StateCode jsonrpc_service_register_method(HANDLE hservice, const char *name, 
                                   jsonrpc_method_handler handler, void *user_data);

/**********************************************************************
 * 函数名称：jsonrpc_service_unregister_method
 * 功能描述：注销JSON-RPC方法
 * 输入参数：无
 * 输出参数：无
 * 返 回 值：    状态码
 * 其它说明：
 * 修改日期        版本号     修改人        修改内容
 * -----------------------------------------------
 * 2025/11/10        V1.0              chengjiahao
 ***********************************************************************/                                   
E_StateCode jsonrpc_service_unregister_method(HANDLE hservice, const char *name);

/**********************************************************************
 * 函数名称：jsonrpc_service_start
 * 功能描述：启动JSON-RPC服务端
 * 输入参数：无
 * 输出参数：无
 * 返 回 值：    状态码
 * 其它说明：
 * 修改日期        版本号     修改人        修改内容
 * -----------------------------------------------
 * 2025/11/10        V1.0              chengjiahao
 ***********************************************************************/
int jsonrpc_service_start(HANDLE hservice);

/**********************************************************************
 * 函数名称：jsonrpc_service_stop
 * 功能描述：停止JSON-RPC服务端
 * 输入参数：无
 * 输出参数：无
 * 返 回 值：    状态码
 * 其它说明：
 * 修改日期        版本号     修改人        修改内容
 * -----------------------------------------------
 * 2025/11/10        V1.0              chengjiahao
 ***********************************************************************/
void jsonrpc_service_stop(HANDLE hservice);

/**********************************************************************
 * 说明
 * 本库在 HTTP JSON-RPC 模式下仅保留“同步请求-响应”机制：
 * - 业务处理函数 `jsonrpc_method_handler` 直接返回 `cJSON*` 作为 result
 * - 不再提供异步消息分配/释放/回包接口
 ***********************************************************************/

EXTERN_C_BLOCK_END

#endif // JSONRPC_SERVICE_H